# Monitoring Process Federation Server instances using the Runtimedata REST API

Process Federation Server Runtimedata
REST API provides insights into Process Federation Server instances
through a hierarchical JSON view of their configuration augmented with runtime data and key
performance indicators (KPI) that can be used to monitor a federated environment.

The Runtimedata REST API has no dependencies on external systems availability and is always
available as long as the Process Federation Server instance is
running. As this REST API collects runtime data and KPI from internal Process Federation Server components
rather than from external systems, it also has a predictable response time that is not impacted by
the response time or availability of the federated systems and external components.

Access to the Runtimedata REST API must be granted to specific Process Federation Server users by
assigning them the pfsAdministrator role in the server.xml file, as in the following example:

```
<authorization-roles id="com.ibm.bpm.federated.rest.authorization">
  <security-role name="pfsAdministrator">
    <!— Grant the pfsAdministrator role to user monitoring-user -->
    <user name="monitoring-user"/>
    <!— Grant the pfsAdministrator role to all users that belong to the group pfs-administrators  -->
    <group name=”pfs-administrators”/>
  </security-role>
</authorization-roles>
```

The API provides two endpoints:

- GET /pfsconsole/api/v1/node/runtimedata: provides information about
the Process Federation Server
instance on which the REST API is called. This REST API is available out of the box without
additional configuration needed in server.XML. See GET /pfsconsole/api/v1/node/runtimedata for the API documentation.
- GET /pfsconsole/api/v1/cluster/runtimedata: provides information
about a list of Process Federation Server instances. The
list of Process Federation Server instances that this REST API returns information about needs to be configured in server.XML. See
GET /pfsconsole/api/v1/cluster/runtimedata for the API documentation.

## GET /pfsconsole/api/v1/node/runtimedata

Provides information about the Process Federation Server instance on which the REST API is
called. This REST API is available out of the box without additional configuration needed in
server.xml.

The JSON data returned by this REST API has the following format:

```
{
  "time": {
    "start": "…",
    "end": "…"
  },
  "status": …,
  "statusMessage": "…",
  "federatedDataRepository": {…},
  "federatedSystems": […]
}
```

| JSON Field              | Description                                                                                                                                                                                                                                                                      |
|-------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| time                    | Information about when the request was processed: the start field is a timestamp (as a date time string format) of when the processing of the request started, the end field is a timestamp (also as a date time string format) of when the processing of the request completed. |
| status                  | The HTTP response status code.                                                                                                                                                                                                                                                   |
| statusMessage           | A message detailing the HTTP response status code.                                                                                                                                                                                                                               |
| federatedDataRepository | Information about the federated data repository (either an elasticsearch or an opensearch cluster) that this Process Federation Server instance is configured to use. See federatedDataRepository for more details.                                                              |
| federatedSystems        | Information about the systems that this Process Federation Server instance is configured to federate. This is an array of federatedSystem JSON objects. See federatedSystem for more details.                                                                                    |

federatedDataRepository JSON object

Provides information about a federated data repository set up for a Process Federation Server
instance and has the following format:

```
{
  "isAvailable": true | false,
  "config.displayId": "ibmPfs\_remoteElasticsearch",
  "endpoints": […],
  "username": "…",
  […]
  "vendor": "Elasticsearch" | "Opensearch",
  "version": "…",
  "clusterName": "…",
  "clusterUUID" "…"
}
```

| JSON Field       | Description                                                                                                                                                                                                                                                                                                                                                                           |
|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| isAvailable      | true if the configured federated data repository is available for the Process Federation Server instance, false if it is not.                                                                                                                                                                                                                                                         |
| config.displayId | Unique ID that allows retrieving the corresponding configuration element in the server.xml configuration file. For the federated data repository, the value is always “ibmPfs\_remoteElasticsearch”.                                                                                                                                                                                   |
| endpoints        | An array that contains all the endpoints defined with the endpoints configuration property for the federated data repository (values are extracted from the comma separated list of URLs defined in the configuration property).                                                                                                                                                      |
| username         | The value of the username configuration property for the federated data repository.                                                                                                                                                                                                                                                                                                   |
| […]              | The values of all the other configuration properties (either internal, publicly documented or unsupported but anyway defined in the server.xml configuration file) for the federated data repository are also provided in the JSON object.  See Configuration properties for the federated data repository for the public list of federated data repository configuration properties. |
| vendor           | The vendor name, either Elasticsearch or Opensearch, for the federated data repository. This value is only provided if the Process Federation Server instance have been able to connect to the federated data repository.                                                                                                                                                             |
| version          | The version of the Elasticsearch or OpenSearch cluster that is setup as the federated data repository. This value is only provided if the Process Federation Server instance have been able to connect to the federated data repository.                                                                                                                                              |
| clusterName      | The name of the Elasticsearch or OpenSearch cluster that is setup as the federated data repository. This value is only provided if the Process Federation Server instance have been able to connect to the federated data repository.                                                                                                                                                 |
| clusterUUID      | The UUID of the Elasticsearch or OpenSearch cluster that is setup as the federated data repository. This value is only provided if the Process Federation Server instance have been able to connect to the federated data repository.                                                                                                                                                 |

federatedSystem JSON object

Provides information about a federated system set up for a Process Federation Server instance and
has the following format:

```
{
    "isAvailable": true | false,
    "config.displayId": "ibmPfs\_federatedSystem[…]",
    "id”": "…",
    "displayName": "…",
    "restUrlPrefix": "…",
    "indexName": "…",
    "index.number\_of\_replicas": …,
    "index.number\_of\_shards": …,
    "allowedOrigins": "…",
    […],
    "systemType": "…",
    "systemID": "…",
    "version": "…",
    "database": {…},
    "indexers": […],
    "retrievers": […]
}
```

| JSON Field               | Description                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| isAvailable              | true if the configured federated system is available for the Process Federation Server instance, false if it is not.                                                                                                                                                                                                                                             |
| config.displayId         | Unique ID that allows retrieving the corresponding configuration element in the server.xml configuration file. For a federated system, the value is “ibmPfs\_federatedSystem[xxx]” where xxx is the id configuration property (or a generated default value if the id configuration property is missing).                                                         |
| id                       | The value of the id configuration property for the federated system.                                                                                                                                                                                                                                                                                             |
| displayName              | The value of the displayName configuration property for the federated system.                                                                                                                                                                                                                                                                                    |
| restUrlPrefix            | The value of the restUrlPrefix configuration property for the federated system.                                                                                                                                                                                                                                                                                  |
| indexName                | The value of the indexName configuration property for the federated system.                                                                                                                                                                                                                                                                                      |
| index.number\_of\_replicas | The value of the index.number\_of\_replicas configuration property for the federated system.                                                                                                                                                                                                                                                                       |
| index.number\_of\_shards   | The value of the index.number\_of\_shards configuration property for the federated system.                                                                                                                                                                                                                                                                         |
| allowedOrigins           | The value of the allowedOrigins configuration property for the federated system.                                                                                                                                                                                                                                                                                 |
| […]                      | The values of all the other configuration properties (either internal, publicly documented or unsupported but anyway defined in the server.xml configuration file) for the federated system are also provided in the JSON object.  See Configuration properties for federated systems  for the public list of federated system configuration properties.         |
| systemType               | The type of the federated system:   SYSTEM\_TYPE\_WLE for a BPD system    SYSTEM\_TYPE\_WPS for a BPEL system   SYSTEM\_TYPE\_CASE for a Case system   If there is no indexer defined for the federated system, this value is only provided if the Process Federation Server instance have already made at least one HTTP connection to the federated system REST API. |
| systemID                 | The unique ID of the federated system. This value is only provided if the Process Federation Server instance have already made at least one HTTP connection to the federated system REST API.                                                                                                                                                                    |
| version                  | The version of the federated system. This value is only provided if the Process Federation Server instance have already made at least one HTTP connection to the federated system REST API.                                                                                                                                                                      |
| database                 | Information about the federated system database. See federatedSystem for more details.                                                                                                                                                                                                                                                                           |
| indexers                 | Information about the indexers that are setup on the Process Federation Server instance for the federated system. This is an array of indexer JSON objects See indexer for more details.                                                                                                                                                                         |
| retrievers               | Information about the retriever that is setup on the Process Federation Server instance for the federated system. This is an array of zero or one retriever JSON object. See retriever for more details.                                                                                                                                                         |

federatedSystem database JSON object

Provides information about the database set up for a federated system in a Process Federation
Server instance and has the following format:

```
{
    "config.displayId": "dataSource[…]",
    "vendor": "…",
    "serverName": "…",
    "portNumber": …,
    "databaseName": "…",
    "user": "…",
    […],
    "metadata": {
        "productName": "…",
        "productVersion": "…",
        "productMajorVersion": …,
        "productMinorVersion": ….
    }
}
```

| JSON Field       | Description                                                                                                                                                                                                                                                                                                                        |
|------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| config.displayId | Unique ID that allows retrieving the corresponding datasource configuration element in the server.xml configuration file. For a federated system database, the value is “dataSource[xxx]” where xxx is the id configuration property (or a generated default value if the id configuration property is missing) of the datasource. |
| vendor           | The vendor name for the database, according to the configuration of the datasource:   db2   oracle   sqlserver   postgresql                                                                                                                                                                                                        |
| serverName       | The value of the serverName configuration property for the datasource.                                                                                                                                                                                                                                                             |
| portNumber       | The value of the portNumber configuration property for the datasource.                                                                                                                                                                                                                                                             |
| databaseName     | the value of the databaseName configuration property for the datasource.                                                                                                                                                                                                                                                           |
| user             | the value of the user configuration property for the datasource.                                                                                                                                                                                                                                                                   |
| […]              | The values of all the other configuration properties (either internal, publicly documented or unsupported but anyway defined in the server.xml configuration file) for the datasource are also provided in the JSON object.                                                                                                        |
| metadata         | Metadata gathered from the database:   productName   productVersion   productMajorVersion   productMinorVersion   This value is only provided if the Process Federation Server instance have already made at least one connection to the federated system database.                                                                |

indexer JSON object

Provides information about an indexer running in a Process Federation Server instance and
has the following format:

```
{
    "isRunning": true | false,
    "config.displayId": "…",
    "type": "…",
    "schemaName": "…",
    "maintenanceOperations": {…},
    […],
    "status": "…",
    "partition": {
        "min": …,
        "max": …
    },
    "database": {
        "schema": "…",
        "consumerColumn": "…",
        "driverName": "…",
        "driverVersion": "…",
        "driverMajorVersion": …,
        "driverMinorVersion": …
     },
    "kpi": {…},
    "statistics": {…}
}
```

| JSON Field            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| isRunning             | true if this indexer is currently running, false if it is not.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| config.displayId      | Unique ID that allows retrieving the corresponding indexer configuration element in the server.xml configuration file. Depending on the type of indexer, the value is “ibmPfs\_bpdIndexer[xxx]” or “ibmPfs\_bpelIndexer[xxx]” where xxx is the id configuration property (or a generated default value if the id configuration property is missing) of the indexer.                                                                                                                                                                                                                                                                                  |
| type                  | The type of the indexer:   BPD   BPEL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| schemaName            | The value of the database schemaName configuration property for the indexer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| maintenanceOperations | This object gather configuration properties of the indexer that are related to maintenance operations on the PFS change log tables. This object has one field per maintenance operation that can be performed by the indexer (the list depends on the indexer type):   SYNC\_TASKS   SYNC\_INSTANCES   SYNC\_TASK\_DELETES   SYNC\_INSTANCE\_DELETES   COMPACTION   INDEX\_LOG\_TRIM   The value of each one of these fields is an object that contains the values of the related indexer configuration properties for the maintenance operation, along with the next scheduled time of the operation if available (as a property named nextScheduledTime) |
| […]                   | The values of all the other configuration properties (either internal, publicly documented or unsupported but anyway defined in the server.xml configuration file) for the indexer are also provided in the JSON object.  See Configuration properties for federated systems for the public list of indexer configuration properties.                                                                                                                                                                                                                                                                                                              |
| status                | The current status of the indexer:   UNINITIALIZED   INITIALIZING   INITIALIZED   STARTING\_NEW\_CYCLE   CREATING\_ELASTICSEARCH\_INDEX   RESTORING\_ELASTICSEARCH\_INDEX   PERFORMING\_CHANGELOG\_COMPACTION   PERFORMING\_INDEX\_LOG\_TRIM   PERFORMING\_SYNC\_TASKS   PERFORMING\_SYNC\_INSTANCES   PERFORMING\_SYNC\_TASKS\_DELETE   PERFORMING\_SYNC\_INSTANCES\_DELETE   CLAIMING\_CHANGE\_LOG\_ENTRIES   RETRIEVING\_CHANGE\_LOG\_ENTRIES   RETRIEVING\_DATA   INDEXING\_IN\_ELASTICSEARCH   LOGGING\_RESULT   WAITING\_FOR\_NEXT\_CYCLE   INTERRUPTED   STOPPED                                                                                                              |
| partition             | Information about the partition of the PFS change log table that is currently assigned to this indexer, identified by the values of properties min and max. An indexer that is assigned partition [min, max] is exclusively processing the PFS change log table entries that have a value for column PARTITION that is at least min and at most max.                                                                                                                                                                                                                                                                                               |
| database              | Additional database related information for the indexer, when available:   schema: the database schema the index is working with;   consumerColumn: the consumer column that the indexer is using in the PFS change log table;   driverName, driverVersion, driverMajorVersion and driverMinorVersion: metadata from the JDBC driver handling the database connection.                                                                                                                                                                                                                                                                             |
| kpi                   | Key performance indicators for the indexer when available. This is an indexer KPI JSON object. See indexer KPI for more details.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| statistics            | For compatibility with the PFS MBeans monitoring capabilities, the statistics gathered by the PFS indexer MBean are provided in this object. See Monitoring and administering indexers with MBeans.                                                                                                                                                                                                                                                                                                                                                                                                                                                |

indexer KPI JSON object

Provides key performance indicators for an indexer and has the following format:

```
{
  "kpiTimestamp": {…},
  "runningTime": {…},
  "numberOfCompletedCycles": {
    "total": …,
    "inactive": …,
    "active": …
  },
  "cyclesDuration": {
    "active": {…},
    "inactive": {…}
  },
  "lastCycles:" […],
  "lastActiveCycleEnd": {…},
  "lastInactiveCycleEnd": {…},
  "processedChangelogEntries": {…},
  "consumedChangelogEntries": {…},
  "indexUpdates": {…},
  "indexDeletions": {…},
  "maintenanceOperations": {…},
  "warnings": {
    "total": …,
    "lastCycles": […]
  },
  "errors": {
    "total": …,
    "lastCycles": […]
  }  
}
```

| JSON Field                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|---------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| kpiTimestamp              | Information about when the key performance indicators values were collected.  This object has two fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| runningTime               | Information about how long this indexer has been running.  This object has two fields:   ms is a number of milliseconds;   human is a string with a human readable version of the duration (example: “1h 12m 13s”).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| numberOfCompletedCycles   | Information about the number of cycles that were completed by the indexer since it started (one cycle is a loop of the indexer where it runs maintenance operations if they are due and then process at most 1000 new entries in the PFS change log table to update the index accordingly).  This object has three fields:   total is the total number of cycles that were completed by the indexer;   inactive is the total number of inactive cycles that were completed. An inactive cycle is a cycle during which the indexer has not run any maintenance operation and has not found any new entries to process in the PFS change log table;   active is the total number of active cycles (an active cycle is a cycle during which the indexer has run at least one maintenance operation or has processed at least one new entry in the PFS change log table).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| cyclesDuration            | Statistics on the active and inactive cycles duration. For each one of these types of cycles, an object with the following fields is provided:   min is the minimum duration observed for a cycle of this type since the indexer started;   max is the maximum duration observed for a cycle of this type since the indexer started;   total is the total cumulated duration of all completed cycles of this type since the indexer started;   avg is the average duration of a cycle of this type since the indexer started.   Each one of these fields is an object with the following fields:   ms is a number of milliseconds;   human is a string with a human readable version of the duration (example: “1.51s”).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| lastCycles                | An array that provides information about the at most ten last cycles of the indexer. This array contains indexer cycle JSON objects. See indexer cycle for more details.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| lastActiveCycleEnd        | Information about when the last active cycle ended. This object has the following fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| lastInactiveCycleEnd      | Information about when the last inactive cycle ended. This object has the following fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| processedChangelogEntries | Information about the number of entries in the PFS change log table processed by the indexer since it started. During a cycle, the indexer gather at most 1000 unconsumed entries from the PFS change log table to update the corresponding tasks and instances in the federated data repository index. From all the entries gathered from the PFS change log table, the indexer only need to process those that are related to a different task or process instances than the other ones: those entries are referred to as the “processed” change log entries. This object has the following fields:   total is the total number of change log entries that were processed since the indexer started;   min is the lowest number of change log entries that were processed during a cycle since the indexer started;   max is the highest number of change log entries that were processed during a cycle since the indexer started;   avgPerActiveCycle is the average number of change log entries that were processed during the active cycles since the indexer started;   avgPerCycle is the average number of change log entries that were processed during all the cycles since the indexer started.                                                                                                                                                |
| consumedChangelogEntries  | Information about the number of entries in the PFS change log table consumed by the indexer since it started. During a cycle, the indexer gather at most 1000 unconsumed entries from the PFS change log table to update the corresponding tasks and instances in the federated data repository index. Once the federated data repository has been updated, those entries are marked as “consumed”: this field is about those PFS change log table entries that were marked as consumed by the indexer. This object has the following fields:   total is the total number of change log entries that were consumed since the indexer started;   min is the lowest number of change log entries that were consumed during a cycle since the indexer started;   max is the highest number of change log entries that were consumed during a cycle since the indexer started;   avgPerActiveCycle is the average number of change log entries that were consumed during each active cycle since the indexer started;   avgPerCycle is the average number of change log entries that were consumed during each cycle, active or inactive, since the indexer started.                                                                                                                                                                                            |
| indexUpdates              | Information about the number of documents created or updated in the federated data repository by the indexer since it started. This object has the following fields:   total is the total number of documents that were created or updated in the federated data repository by the indexer since it started;   min is the lowest number of documents that were created or updated in the federated data repository by the indexer during a cycle since the indexer started;   max is the highest number of documents that were created or updated in the federated data repository by the indexer during a cycle since the indexer started;   avgPerActiveCycle is the average number of documents that were created or updated in the federated data repository by the indexer during each active cycle since the indexer started;   avgPerCycle is the average number of documents that were created or updated in the federated data repository by the indexer during each cycle, active or inactive, since the indexer started                                                                                                                                                                                                                                                                                                                          |
| indexDeletions            | Information about the number of documents deleted in the federated data repository by the indexer since it started. This object has the following fields:   total is the total number of documents that were deleted from the federated data repository by the indexer since it started;   min is the lowest number of documents that were deleted from the federated data repository by the indexer during a cycle since the indexer started;   max is the highest number of documents that were deleted from the federated data repository by the indexer during a cycle since the indexer started;   avgPerActiveCycle is the average number of documents that were deleted from the federated data repository by the indexer during each active cycle since the indexer started;   avgPerCycle is the average number of documents that were deleted from the federated data repository by the indexer during each cycle, active or inactive, since the indexer started                                                                                                                                                                                                                                                                                                                                                                                  |
| maintenanceOperations     | Information about the maintenance operations that were performed by the indexer since it started. This object has one field per maintenance operation that has been performed by the indexer (the list depends on the indexer type):   SYNC\_TASKS   SYNC\_INSTANCES   SYNC\_TASK\_DELETES   SYNC\_INSTANCE\_DELETES   COMPACTION   INDEX\_LOG\_TRIM   The value of each one of these fields is an object that contains the following fields:   count is the number of time that this maintenance operation was performed by the indexer since it started;   duration is an object with information related to the duration of this maintenance operation.   The duration object has the following fields:   total is the total amount of time spent by the indexer performing this maintenance operation since the indexer started.    min is the lowest duration of this maintenance operation when performed by this indexer since it started;   max is the highest duration of this maintenance operation when performed by the indexer since it started;   avg is the average duration of the maintenance operation when performed by the indexer since it started.   Each one of these fields is an object with the following fields:   ms is a number of milliseconds;   human is a string with a human readable version of the duration (example: “4.12s”). |
| warnings                  | Information about the warnings reported by the indexer since it started. This object has the following fields:   total is the total number of warnings reported by the indexer since it started;   lastCycles is an array with information about the at most ten last cycles during which a warning was reported. This array contains indexer cycle JSON objects. See indexer cycle for more details.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| errors                    | Information about the errors reported by the indexer since it started. This object has the following fields:   total is the total number of errors reported by the indexer since it started;   lastCycles is an array with information about the at most ten last cycles during which an error was reported. This array contains indexer cycle JSON objects. See indexer cycle for more details.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |

indexer cycle JSON object

This JSON object provides information about an indexer cycle and has the following format:

```
{
  "start": {…},
  "end": {…},
  "duration": {…},
  "processedChangelogEntries": …,
  "consumedChangelogEntries": …,
  "indexUpdates": …,
  "indexDeletions": …,
  "maintenanceOperations": {…},
  "warnings": […],
  "errors": […]
}
```

| JSON Field                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| start                     | Information about when the cycle started. This object has two fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.                                                                                                                                                                                                                                                                                                                                                                                                                           |
| end                       | Information about when the cycle ended. This object has two fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| duration                  | Information about the duration of the cycle. This object has two fields:   ms is a number of milliseconds;   human is a string with a human readable version of the duration (example: “1.02s”).                                                                                                                                                                                                                                                                                                                                                                                                                      |
| processedChangelogEntries | Number of entries in the PFS change log table processed by the indexer during the cycle. During a cycle, the indexer gather at most 1000 unconsumed entries from the PFS change log table to update the corresponding tasks and instances in the federated data repository index. From all the entries gathered from the PFS change log table, the indexer only need to process those that are related to a different task or process instances than the other ones: those entries are referred to as the “processed” change log entries.                                                                             |
| consumedChangelogEntries  | Number of entries in the PFS change log table consumed by the indexer during the cycle. During a cycle, the indexer gather at most 1000 unconsumed entries from the PFS change log table to update the corresponding tasks and instances in the federated data repository index. Once the federated data repository has been updated, those entries are marked as “consumed”: this field is about those PFS change log table entries that were marked as consumed by the indexer.                                                                                                                                     |
| indexUpdates              | Number of documents created or updated in the federated data repository by the indexer during the cycle.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| indexDeletions            | Number of documents deleted from the federated data repository by the indexer during the cycle.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| maintenanceOperations     | Information about the maintenance operations performed by the indexer during the cycle. This object has one field per maintenance operation that has been performed by the indexer during the cycle (the list depends on the indexer type):   SYNC\_TASKS   SYNC\_INSTANCES   SYNC\_TASK\_DELETES   SYNC\_INSTANCE\_DELETES   COMPACTION   INDEX\_LOG\_TRIM   Each one of these fields is an object with the following fields to indicate the duration of the maintenance operation during the cycle:   ms is a number of milliseconds;   human is a string with a human readable version of the duration (example: “4.23s”). |
| warnings                  | Array of all the warning messages (strings) reported by the indexer during the cycle.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| errors                    | Array of all the error messages (strings) reported by the indexer during the cycle.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

retriever JSON object

Provides information about a retriever set up for a federated system in a Process Federation
Server instance and has the following format:

```
{
    "isRunning": true | false,
    "config.displayId": "…",
    "internalRestUrlPrefix": "…",
    […],
    "kpi": {…}
}
```

| JSON Field            | Description                                                                                                                                                                                                                                                                                                                                                                                            |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| isRunning             | true if this indexer is currently running, false if it is not.                                                                                                                                                                                                                                                                                                                                         |
| config.displayId      | Unique ID that allows retrieving the corresponding indexer configuration element in the server.xml configuration file. Depending on the type of retriever, the value is “ibmPfs\_bpdRetriever[xxx]”, “ibmPfs\_bpelRetriever[xxx]” or “ibmPfs\_caseRetriever[xxx]” where xxx is the id configuration property (or a generated default value if the id configuration property is missing) of the retriever. |
| internalRestUrlPrefix | The value of the internalRestUrlPrefix configuration property for the retriever.                                                                                                                                                                                                                                                                                                                       |
| […]                   | The values of all the other configuration properties (either internal, publicly documented or unsupported but anyway defined in the server.xml configuration file) for the retriever are also provided in the JSON object.  See Configuration properties for federated systems for the public list of retriever configuration properties.                                                              |
| kpi                   | Key performance indicators for the retriever when available. This is a retriever KPI JSON object. See retriever KPI for more details.                                                                                                                                                                                                                                                                  |

retriever KPI JSON object

This JSON object provides key performance indicators for a retriever and has the following
format:

```
{
  "kpiTimestamp": {…},
  "restAPICalls": {
    "total": …,
    "lastRestAPICallEnd": {…},
    "SYSTEM\_STATUS": {
      "count": …,
      "duration": {
        "total": {…},
        "min": {…},
        "max": {…},
        "avg": {…}
      },
      "errors": {
        "total": …
      }
    },
    "LAUNCH\_LIST": {…},
    "USER\_GROUPS\_IDS": {…},
    "META\_BUSINESS\_DATA\_FIELDS": {…},
    "GLOBAL\_TEAMS": {…},
    "GLOBAL\_TEAM\_USERS": {…},
    "GLOBAL\_TEAMS\_MEMBERSHIPS": {…},
    "MANAGED\_TEAMS": {…},
    "MANAGED\_TEAMS\_MEMBERSHIPS": {…},
    "PROCESSES": {…}
  },
  "lastRestAPICalls": […],
  "errors": {
    "total": …,
    "lastErrorTimestamp": {…},
    "lastRestAPICallsWithError": […]
  }
}
```

| JSON Field       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| kpiTimestamp     | Information about when the key performance indicators values were collected.  This object has two fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| restAPICalls     | Information about the different calls to the federated system’s REST API performed by the retriever since it started. This object has the following fields:   total is the total number of calls to the federated system’s REST API performed by the retriever since it started;   lastRestAPICallEnd is the date and time of the end of the last call to the federated system’s REST API performed by the retriever. This is an object with the following fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as adate time string format.      This object also has one additional field per federated system’s REST API that can be called by the retriever, providing information for each one:   SYSTEM\_STATUS for the calls to retrieve the status of the federated system;   LAUNCH\_LIST for the calls to retrieve the list of launchable entities of the federated system;   USER\_GROUPS\_IDS for the calls to retrieve a user’s groups memberships on the federated system;   META\_BUSINESS\_DATA\_FIELDS for the calls to retrieve business fields metadata on the federated system;   GLOBAL\_TEAMS for the calls to retrieve a list of teams on the federated system;   GLOBAL\_TEAMS\_MEMBERSHIPS for the calls to check if the user is a member of a team on the federated system;   GLOBAL\_TEAM\_USERS for the calls to retrieve a list of users that belong to a team on the federated system;   MANAGED\_TEAMS for the calls to retrieve a list of teams manager by the user on the federated system;   MANAGED\_TEAMS\_MEMBERSHIPS for the calls to check if the user is a manager of a team on the federated system;   PROCESSES for the calls to retrieve a list of processes, on the federated system,,that have performance metrics exposed to the user.   Each one of these additional fields is an object with the following inner fields:   count is the number of time that this REST API has been called by the retriever since it started;   errors provides information about the errors that occurred when calling the federated system REST API. This object has a single field, total, that is the total number of errors encountered when calling this federated system REST API;   duration provides information about the duration of those calls. It is an object with the following fields:   total is the total amount of time spent by the retriever calling this REST API since the retriever started;   min is the duration of the call to this REST API that took the less time;    max is the duration of the call to this REST API that took the most time;   avg is the average duration of a call since to this REST API since the retriever started.     total, min, max and avg are themselves objects with the following fields:   ms is a number of milliseconds;   human is a string with a human readable version of the duration (example: “4.23s”). |
| lastRestAPICalls | An array that provides information about the at most ten last federated system REST API calls of the indexer. This array contains retriever call JSON objects. See retriever call for more details.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| errors           | Information about the errors encountered by the indexer, since it started, during federated system REST API calls. This object has the following fields:   total is the total number of errors;   lastErrorTimestamp is the information about when the last error occurred. This object has two fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.      lastRestAPICallsWithError provides information about the at most ten last federated system REST API calls on which an error was encountered. This is an array of retriever call JSON objects. See retriever call for more details.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

retriever call JSON object

Provides information about a retriever call to a federated system REST API and has the following
format:

```
{
  "type": "…",
  "path": "…",
  "user": "…",
  "start": {…},
  "end": {…},
  "duration": {…},
  "status": "…",
  "error": true | false
}
```

| JSON Field   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| type         | The type of call, which is one of the following:   “SYSTEM\_STATUS” for a call to retrieve the status of the federated system;   “LAUNCH\_LIST” for a call to retrieve the list of launchable entities of the federated system;   “USER\_GROUPS\_IDS” for a call to retrieve a user’s groups memberships on the federated system;   “META\_BUSINESS\_DATA\_FIELDS” for a call to retrieve business fields metadata on the federated system;   “GLOBAL\_TEAMS” for a call to retrieve a list of teams on the federated system;   “GLOBAL\_TEAMS\_MEMBERSHIPS” for a call to check if the user is a member of a team on the federated system;   “GLOBAL\_TEAM\_USERS” for a call to retrieve a list of users that belong to a team on the federated system;   “MANAGED\_TEAMS” for a call to retrieve a list of teams manager by the user on the federated system;   “MANAGED\_TEAMS\_MEMBERSHIPS” for a call to check if the user is a manager of a team on the federated system;   “PROCESSES” for a call to retrieve a list of processes, on the federated system,,that have performance metrics exposed to the user. |
| path         | The path of the REST API that was called on the federated system, relative to the internalRestUrlPrefix configuration property for the retriever.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| user         | The id of the user for which the federated system REST API was called.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| start        | Information about when the REST API call was initiated. This object has two fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| end          | Information about when the REST API call was completed. This object has two fields:   ts is a timestamp as a number of milliseconds since the epoch;   human is a timestamp as a date time string format.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| duration     | Information about the duration of the REST API call. This object has two fields:   ms is a number of milliseconds;   human is a string with a human readable version of the duration (example: “4.23s”).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| status       | The status string of the REST API call response (HTTP status code + message)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| error        | true if the status code indicates and error, false otherwise.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

## GET /pfsconsole/api/v1/cluster/runtimedata

This REST API endpoint provides information about a list of Process Federation Server instances.
The list of Process Federation Server instances needs to be configured with the
<ibmPfs\_console> configuration element in the server.xml configuration file. The list of
Process Federation Server instances must be provided as a comma separated list of endpoints, an
endpoint being the base URL from which the Process Federation Server instance REST API can be
called, using the pfsNodesEndpoints configuration attribute:

```
<ibmPfs\_console pfsNodesEndpoints="https://pfs1.my.domain:9444,https://pfs2.my.domain:9444" />
```

The Process Federation Server instance that process the GET
/pfsconsole/api/v1/cluster/runtimedata request calls the GET
/pfsconsole/api/v1/node/runtimedata on each of the configured endpoint and merge the results in
a single response that has the following format:

```
{
  "time": {
    "start": "…",
    "end": "…"
  },
  "status": …,
  "statusMessage": "…",
  "nodes": […]
}
```

| JSON Field    | Description                                                                                                                                                                                                                                                                                                               |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| time          | Information about when the request was processed: the start field is a timestamp (as a date time string) of when the processing of the request started, the end field is a timestamp (also as a date time string) of when the processing of the request completed.                                                        |
| status        | The HTTP response status code.                                                                                                                                                                                                                                                                                            |
| statusMessage | A message detailing the HTTP response status code.                                                                                                                                                                                                                                                                        |
| nodes         | An array with the runtime data of each Process Federation Server instance configured with the pfsNodesEndpoints configuration attribute of the <ibmPfs\_console> configuration element in server.xml This is an array of Process Federation Server node JSON objects. See Process Federation Server node for more details. |

Process Federation Server node JSON object

Provides the runtime data of a Process Federation Server instance and has the following schema:

```
{
  "endpoint": "…",
  "url": "…",
  "status": …,
  "statusMessage": "…",
  "data": {…}
}
```

| JSON Field    | Description                                                                                                      |
|---------------|------------------------------------------------------------------------------------------------------------------|
| endpoint      | The endpoint for the Process Federation Server instance.                                                         |
| url           | The url that was called to gather the runtime data of the Process Federation Server instance.                    |
| status        | The HTTP response status code for the url call.                                                                  |
| statusMessage | A message detailing the HTTP response status code.                                                               |
| data          | The JSON data returned by the url call. See GET /pfsconsole/api/v1/node/runtimedata for the format of this data. |