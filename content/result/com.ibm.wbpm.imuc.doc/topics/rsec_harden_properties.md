# Security-hardening properties

## Hardening IBM Business Automation Workflow

| Property                                                              | Accepted values                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Example                                                                                                                                                                                                                                                                                                                           | Default value                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Security.CommonLogoutExitPage                                         | A full URL (absolute or relative) to which the user is redirected after logout. This action allows logging out of SSO solutions as part of logging out of Workflow. This property has no default value. This setting overrides individual logout pages that are configured for individual web applications as described in Configuring third-party authentication products.If any of the URLs of the custom logout pages are not on the same host as the Business Automation Workflow server, or do not belong to the same domain, you must set one of the com.ibm.websphere.security.allowAnyLogoutExitPageHost or com.ibm.websphere.security.logoutExitPageDomainList global security custom properties. For more information about these custom properties, see Security custom properties.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | AdminTask.setBPMProperty(['-de', 'De1',     '-name', 'Security.CommonLogoutExitPage',     '-value', 'https://ums.customer.com/ums/logout'])                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                 |
| Security.CheckXSRFForOldRestApi                                       | This property controls whether Business Automation Workflow validates the cookie "XSRF-TOKEN" against incoming REST API requests (POST/PUT/DELETE) with the path pattern "/rest/bpm/wle/v1/*". The value must be TRUE or FALSE.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | AdminTask.setBPMProperty(['-de', 'De1', '-name', 'Security.CheckXSRFForOldRestApi', '-value', 'FALSE'])                                                                                                                                                                                                                           | TRUE                                                                                                                                                                                                                                                                                                                                                            |
| Security.UserAgentKeywordWhiteListForOldRestAPICSRFCheck              | The value of this property must be a comma-separated list of keywords of the user agents that Business Automation Workflow must not validate the cookie "XSRF-TOKEN" against incoming REST API requests with the path pattern "/rest/bpm/wle/v1/*".                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | AdminTask.setBPMProperty(['-de', 'De1', '-name', 'Security.UserAgentKeywordWhiteListForOldRestAPICSRFCheck', '-value', 'Java,Wink Client,HttpClient,curl,Jersey,HttpUrlConnection,MyNewAgent'])                                                                                                                                   | Java, Wink Client,HttpClient,curl,Jersey,HttpUrlConnection                                                                                                                                                                                                                                                                                                      |
| Security.CsrfProtectionRefererWhitelist                               | The value of this property must be a comma-separated list of fully qualified hostnames that are valid values for the Referer header field. By restricting values to hostnames that serve user interfaces for Business Automation Workflow, you can mitigate CSRF. For more information about the Referer header field, see the Request for Comments (RFC) 7231 documentation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | AdminTask.setBPMProperty(['-de', 'De1', '-name',  'Security.CsrfProtectionRefererWhitelist', '-value',  'fmtc4090.boeblingen.de.ibm.com'])                                                                                                                                                                                        | Unassigned, which allows the header of the HTTP request to contain any value.                                                                                                                                                                                                                                                                                   |
| Security.CsrfProtectionOriginWhitelist                                | The value of this property must be a comma-separated list of prefixes in the format protocol://host:port that are acceptable values in the Origin header field. By restricting possible values to hostnames and domain names that serve user interfaces for Business Automation Workflow, you can mitigate CSRF. For more information about the Origin header, see the RFC 6454 documentation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | AdminTask.setBPMProperty(['-de', 'De1', '-name',     'Security.CsrfProtectionOriginWhitelist', '-value',     'https://fmtc4090.boeblingen.de.ibm.com'])                                                                                                                                                                           | Unassigned, which allows the header of the HTTP request to contain any value.                                                                                                                                                                                                                                                                                   |
| Security.XFrameOptionsHeaderValue (deprecated)                        | Note: The Security.XFrameOptionsHeaderValue property is deprecated. Use the Security.ContentSecurityPolicyHeaderValue property instead. The Content-Security-Policy HTTP header has a frame-ancestors directive which obsoletes this header for supporting browsers.  You set the value of the X-Frame-Options header field of the HTTP response with this property. Business Automation Workflow returns this value to client requests. The value disallows browsers to embed Business Automation Workflow user interfaces in iframes and thus mitigates potential clickjacking attacks. You can set the following values: DENY: This value specifies that Business Automation Workflow must not be embedded in iframes. Note: This value does not work with client-side human services and IBM Process Portal.  SAMEORIGIN: This value is used for most scenarios. Business Automation Workflow user interfaces can be embedded in iframes, if the iframe element is served from the same origin as the Business Automation Workflow user interface. ALLOW-FROM https://example.com/: This value allows the browser to embed Business Automation Workflow in iframes served from the https://example.com/ URI.  For more information about the X-Frame-Origin options, see the RFC 7034 documentation.                                                                                                                                                                                                                                                          | AdminTask.setBPMProperty(['-de', 'De1', '-name',     'Security.XFrameOptionsHeaderValue', '-value', 'SAMEORIGIN'])                                                                                                                                                                                                                | Unassigned, which omits the X-Frame-Options field in the response header.                                                                                                                                                                                                                                                                                       |
| Security.ContentSecurityPolicyHeaderValue                             | You set the value of the Content-Security-Policy and X-Content-Security-Policy HTTP response header fields with this property. Business Automation Workflow returns this value to client requests. The value instructs the browser to load and run assets in the context of Business Automation Workflow user interfaces only from a set of allowed origins. For example, the policy default-src 'unsafe-inline' 'unsafe-eval' https://bpm1.ibm.com https://bpm1; img-src data: https://bpm1.ibm.com https://bpm1 instructs the browser to retrieve images from data: URIs and from URIs that meet one of the two allowed URI patterns.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | AdminTask.setBPMProperty(['-de', 'De1', '-name',     'Security.ContentSecurityPolicyHeaderValue', '-value', "default-src 'self' 'unsafe-inline'     'unsafe-eval' https://fmtc4090.boeblingen.de.ibm.com ;frame-ancestors 'self'; img-src 'self' data:; font-src 'self' fonts.gstatic.com"])                                      | default-src 'self'; frame-ancestors 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: https:; font-src 'self' fonts.gstatic.com data:; worker-src 'self' blob:; child-src 'self' blob:; frame-src 'self' https: blob:                                                                       |
| Security.StrictTransportSecurityHeaderValue                           | You set the value of the Strict-Transport-Security HTTP response header field with this property. Business Automation Workflow returns this value to client requests. The value instructs the browser to upgrade any http:// link to the server to an https:// link. For more information about the Strict-Transport-Security header, see the RFC 6797 RFC documentation. A sample value is max-age=100; includeSubDomains.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | AdminTask.setBPMProperty(['-de', 'De1', '-name',     'Security.StrictTransportSecurityHeaderValue', '-value', "max-age=100;     includeSubDomains"])                                                                                                                                                                              | max-age=31536000; includeSubDomains                                                                                                                                                                                                                                                                                                                             |
| Security.XXssProtectionHeaderValue                                    | You set the value of the X-XSS-Protection HTTP response header field with this property. Business Automation Workflow returns this value to client requests. The value instructs the browser to enable its built-in cross-site scripting protection, independent of the user's configuration. Setting this property can be useful if the Internet Explorer browser categorizes Business Automation Workflow to run in the intranet zone, which applies weaker browser security settings. A sample value is 1; mode=block.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | AdminTask.setBPMProperty(['-de', 'De1', '-name',     'Security.XXssProtectionHeaderValue', '-value', "1;     mode=block"])                                                                                                                                                                                                        | 1; mode=block                                                                                                                                                                                                                                                                                                                                                   |
| Security.XContentTypeOptionsHeaderValue                               | You set the value of the X-Content-Type-Options HTTP response header field with this property. Business Automation Workflow returns this value to client requests. For example, a value of nosniff instructs browsers to disable MIME-type sniffing (a technique that tries to determine a suitable rendering strategy for server content based on the contents of the HTTP response). MIME-type sniffing can interfere with the explicit overwriting of MIME types in Business Automation Workflow document downloads and thus rerun JavaScript even if Business Automation Workflow explicitly set the Content-Type header to force the download window.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | AdminTask.setBPMProperty(['-de', 'De1', '-name',     'Security.XContentTypeOptionsHeaderValue', '-value', "nosniff"])                                                                                                                                                                                                             | nosniff                                                                                                                                                                                                                                                                                                                                                         |
| Security.CsrfSessionTokenSalt  Security.CsrfSessionTokenProtectedUris | You enable session-specific tokens to mitigate CSRF with these properties. Do not set the HTTPOnly flag because the CSRF token is a double-submit token. To generate identical CSRF protection tokens on all cluster members without sharing the generated tokens, use the  Security.CsrfSessionTokenSalt property. To activate the CSRF protection token, set any value for Security.CsrfSessionTokenSalt. For the server to check for CSRF protection, use the Security.CsrfSessionTokenProtectedUris property. The only supported URI prefixes for this feature are /teamworks/ajaxCoach for coach navigation, /teamworks/cs\_ for Process Admin Console, /teamworks/instrumentation for Process Admin Console Instrumentation and /PerformanceAdmin/console/instrumentation for Performance Admin Instrumentation. The recommended value is /teamworks/ajaxCoach,/teamworks/cs\_,/teamworks/instrumentation,/PerformanceAdmin/console/instrumentation to protect.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | AdminTask.setBPMProperty(['-de', 'De1', '-name',  'Security.CsrfSessionTokenProtectedUris', '-value', '/teamworks/ajaxCoach,/teamworks/cs\_,/teamworks/instrumentation,/PerformanceAdmin/console/instrumentation']) AdminTask.setBPMProperty(['-de', 'De1', '-name',     'Security.CsrfSessionTokenSalt', '-value', 'verySecret']) | The default for Security.CsrfSessionTokenSalt is a system generated random value, which is set in the configuration to make sure that the same value is shared by all cluster members. The default value of Security.CsrfSessionTokenProtectedUris is /teamworks/ajaxCoach,/teamworks/cs\_,/teamworks/instrumentation,/PerformanceAdmin/console/instrumentation. |
| Security.AllowedHttpMethods                                           | In Business Automation Workflow, web applications process requests for a small set of well-known HTTP methods. For a minimal attack surface, it is a good security practice to respond with an HTTP 403 (forbidden) status code if a request uses an unexpected HTTP method. This action avoids unintentionally triggered default code paths that are implemented in various web application frameworks.The value of this property is a comma-separated list of acceptable HTTP methods, such as the following methods that are set by default:   GET PUT POST DELETE HEAD OPTIONS   Any requests with a method that isn't on the allowlist is rejected with the message HTTP 403 (forbidden). Although the methods that are set by default are all used by the REST API, you can apply restrictions to the methods by using the WSADMIN setBPMProperty command to configure the property. For more information, see the topic setBPMProperty command. Any customization of Heritage Process Portal (deprecated) themes (and Business Space) requires a WebDAV connection. WebDAV uses exotic HTTP methods that are defined in their documentation about HTTP extensions for distributed authoring. Heritage Process Portal theme customizations are not relevant to all customers. The few customers who need this capability usually require it temporarily. Therefore, WebDAV HTTP methods are not on the allowlist by default. WebDAV HTTP methods can be temporarily enabled while customizing Heritage Process Portal or Business Space themes (if needed). | AdminTask.setBPMProperty(['-de', 'De1', '-name',  'Security.AllowedHttpMethods', '-value',  'GET,PUT,POST,DELETE,HEAD,OPTIONS'])                                                                                                                                                                                                  | GET,PUT,POST,DELETE,HEAD,OPTIONS                                                                                                                                                                                                                                                                                                                                |

```
Security.AllowedHttpMethods
Security.ContentSecurityPolicyHeaderValue
Security.CsrfSessionTokenProtectedUris
Security.StrictTransportSecurityHeaderValue
Security.XContentTypeOptionsHeaderValue- 
Security.XXssProtectionHeaderValue
```

If your custom user interface application requires
browsers to allow more origins or features, configure the exact header values that you need Business Automation Workflow to return. For example,
you might need to extend the Security.ContentSecurityPolicyHeaderValue with extra
origins to load images, stylesheets, or even scripts from other sources.

Configuring this
Business Automation Workflow as one of the
federated Business Automation Workflow
systems for Process Federation Server and federated
portal or integrating with BA Studio of IBM Cloud Pak for Business
Automation.

- All federated BAW/BPM systems (bpm1.ibm.com) need to configure
Security.ContentSecurityPolicyHeaderValue to a value as shown.
default-src 'self'; frame-ancestors 'self' https://fp1.fyre.ibm.com; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: https:; font-src 'self' fonts.gstatic.com data:; worker-src 'self' blob:; child-src 'self' blob:; frame-src 'self' https: blob:
- If non - default HTTP port is used, for example, 9443, then the configuration is shown:
default-src 'self'; frame-ancestors 'self' https://fp1.fyre.ibm.com:9443; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: https:; font-src 'self' fonts.gstatic.com data:; worker-src 'self' blob:; child-src 'self' blob:; frame-src 'self' https: blob:

```
de = 'De1'

def printSetting(propertyName):
  value = AdminTask.getBPMProperty(['-de', de, '-name', propertyName])
  if value:
    print propertyName+': ' + value
  elif propertyName == 'Security.XFrameOptionsHeaderValue':
    print propertyName + ' is not set, it is obsolete, use CSP frame-ancestors instead.'
  else:
    print propertyName + ' is not set.'
print 'Security hardening settings:'  
printSetting('Security.CsrfProtectionRefererWhitelist')
printSetting('Security.CsrfProtectionOriginWhitelist')
printSetting('Security.XFrameOptionsHeaderValue')
printSetting('Security.ContentSecurityPolicyHeaderValue')
printSetting('Security.StrictTransportSecurityHeaderValue')
printSetting('Security.XXssProtectionHeaderValue')
printSetting('Security.XContentTypeOptionsHeaderValue')
printSetting('Security.CsrfSessionTokenSalt')
printSetting('Security.CsrfSessionTokenProtectedUris')
printSetting('Security.AllowedHttpMethods')
```

Store the script in a path accessible from
your wsadmin scripting client; for example,
path\_to\_script/printSecuritySettings.jy.

```
wsadmin -conntype none -lang jython -f path\_to\_script/printSecuritySettings.jy
```

```
WASX7357I: By request, this scripting client is not connected to any server process. oCertain configuration and application operations will be available in local mode.
Security hardening settings:
Security.CsrfProtectionRefererWhitelist is not set.
Security.CsrfProtectionOriginWhitelist is not set.
Security.XFrameOptionsHeaderValue is not set, it is obsolete, use CSP frame-ancestors instead.
Security.ContentSecurityPolicyHeaderValue is not set.
Security.StrictTransportSecurityHeaderValue is not set.
Security.XXssProtectionHeaderValue is not set.
Security.XContentTypeOptionsHeaderValue is not set.
Security.CsrfSessionTokenSalt is not set.
Security.CsrfSessionTokenProtectedUris is not set.
Security.AllowedHttpMethods: GET,PUT,POST,DELETE,HEAD,OPTIONS
```

## Hardening WebSphere Application
Server

1. Before V22.0.1, by default, TLS secured communication is compatible, which allows older clients
to connect (and be connected to) by using TLS 1.0 and TLS 1.1. New installations of V22.0.1 and
later have a more secure default that enables only the TLS 1.2 and 1.3 protocol versions. In earlier
releases and upgraded environments, restrict the set of TLS protocol versions and available ciphers
by updating the default SSL configuration by using a script
like:AdminTask.modifySSLConfig('[-alias NodeDefaultSSLSettings -sslProtocol TLSv1.3,TLSv1.2 -securityLevel CUSTOM -enabledCiphers "TLS\_AES\_256\_GCM\_SHA384 TLS\_AES\_128\_GCM\_SHA256 TLS\_CHACHA20\_POLY1305\_SHA256 SSL\_ECDHE\_ECDSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_ECDHE\_ECDSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_ECDHE\_RSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_ECDHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_DHE\_RSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_DHE\_DSS\_WITH\_AES\_256\_GCM\_SHA384 SSL\_DHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_DHE\_DSS\_WITH\_AES\_128\_GCM\_SHA256 SSL\_ECDHE\_ECDSA\_WITH\_AES\_256\_CBC\_SHA384 SSL\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 SSL\_ECDHE\_ECDSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA256 SSL\_DHE\_DSS\_WITH\_AES\_256\_CBC\_SHA256 SSL\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_DHE\_DSS\_WITH\_AES\_128\_CBC\_SHA256 SSL\_ECDH\_ECDSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_ECDH\_RSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_ECDH\_ECDSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_ECDH\_RSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_ECDH\_ECDSA\_WITH\_AES\_256\_CBC\_SHA384 SSL\_ECDH\_RSA\_WITH\_AES\_256\_CBC\_SHA384 SSL\_ECDH\_ECDSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_ECDH\_RSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_ECDHE\_ECDSA\_WITH\_AES\_256\_CBC\_SHA SSL\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA SSL\_ECDHE\_ECDSA\_WITH\_AES\_128\_CBC\_SHA SSL\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA SSL\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA SSL\_DHE\_DSS\_WITH\_AES\_256\_CBC\_SHA SSL\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA SSL\_DHE\_DSS\_WITH\_AES\_128\_CBC\_SHA SSL\_ECDH\_ECDSA\_WITH\_AES\_256\_CBC\_SHA SSL\_ECDH\_RSA\_WITH\_AES\_256\_CBC\_SHA SSL\_ECDH\_ECDSA\_WITH\_AES\_128\_CBC\_SHA SSL\_ECDH\_RSA\_WITH\_AES\_128\_CBC\_SHA TLS\_ECDHE\_ECDSA\_WITH\_CHACHA20\_POLY1305\_SHA256 TLS\_ECDHE\_RSA\_WITH\_CHACHA20\_POLY1305\_SHA256 TLS\_DHE\_RSA\_WITH\_CHACHA20\_POLY1305\_SHA256" ]')
AdminTask.modifySSLConfig('[-alias CellDefaultSSLSettings -sslProtocol TLSv1.3,TLSv1.2 -securityLevel CUSTOM -enabledCiphers "TLS\_AES\_256\_GCM\_SHA384 TLS\_AES\_128\_GCM\_SHA256 TLS\_CHACHA20\_POLY1305\_SHA256 SSL\_ECDHE\_ECDSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_ECDHE\_ECDSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_ECDHE\_RSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_ECDHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_DHE\_RSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_DHE\_DSS\_WITH\_AES\_256\_GCM\_SHA384 SSL\_DHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_DHE\_DSS\_WITH\_AES\_128\_GCM\_SHA256 SSL\_ECDHE\_ECDSA\_WITH\_AES\_256\_CBC\_SHA384 SSL\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 SSL\_ECDHE\_ECDSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA256 SSL\_DHE\_DSS\_WITH\_AES\_256\_CBC\_SHA256 SSL\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_DHE\_DSS\_WITH\_AES\_128\_CBC\_SHA256 SSL\_ECDH\_ECDSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_ECDH\_RSA\_WITH\_AES\_256\_GCM\_SHA384 SSL\_ECDH\_ECDSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_ECDH\_RSA\_WITH\_AES\_128\_GCM\_SHA256 SSL\_ECDH\_ECDSA\_WITH\_AES\_256\_CBC\_SHA384 SSL\_ECDH\_RSA\_WITH\_AES\_256\_CBC\_SHA384 SSL\_ECDH\_ECDSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_ECDH\_RSA\_WITH\_AES\_128\_CBC\_SHA256 SSL\_ECDHE\_ECDSA\_WITH\_AES\_256\_CBC\_SHA SSL\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA SSL\_ECDHE\_ECDSA\_WITH\_AES\_128\_CBC\_SHA SSL\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA SSL\_DHE\_RSA\_WITH\_AES\_256\_CBC\_SHA SSL\_DHE\_DSS\_WITH\_AES\_256\_CBC\_SHA SSL\_DHE\_RSA\_WITH\_AES\_128\_CBC\_SHA SSL\_DHE\_DSS\_WITH\_AES\_128\_CBC\_SHA SSL\_ECDH\_ECDSA\_WITH\_AES\_256\_CBC\_SHA SSL\_ECDH\_RSA\_WITH\_AES\_256\_CBC\_SHA SSL\_ECDH\_ECDSA\_WITH\_AES\_128\_CBC\_SHA SSL\_ECDH\_RSA\_WITH\_AES\_128\_CBC\_SHA TLS\_ECDHE\_ECDSA\_WITH\_CHACHA20\_POLY1305\_SHA256 TLS\_ECDHE\_RSA\_WITH\_CHACHA20\_POLY1305\_SHA256 TLS\_DHE\_RSA\_WITH\_CHACHA20\_POLY1305\_SHA256" ]')Note:  22.0.2 

When you install Business Automation Workflow V22.0.1
along with FIPS and TLS v1.3 both enabled, the installation fails because TLS v1.3 is not compatible
with FIPS. Server startup errors can be observed:
10/25/22 9:36:21:007 CEST] 00000001 AdminTool A ADMU3011E: Server launched but failed initialization. Server logs, startServer.log, and other log files under /IBM/WebSphere/AppServer/profiles/dmgr/logs/dmgr should contain failure information.
[10/25/22 9:36:20:796 CEST] 00000001 ORBRas       E com.ibm.ws.orbimpl.transport.WSTransport createServerSocket P=379202:O=0:CT ORBX0390E: Cannot create listener thread. Exception=[ org.omg.CORBA.INTERNAL: CAUGHT\_EXCEPTION\_WHILE\_CONFIGURING\_SSL\_SERVER\_SOCKET, Exception=java.lang.IllegalArgumentException: Current mode settings do not allow the use of CipherSuite TLS\_AES\_256\_GCM\_SHA384 vmcid: 0x49421000 minor code: 77 completed: No - received while attempting to open server socket on port 30114 ].
..FFDC:
[10/25/22 9:36:20:732 CEST]    FFDC Exception:java.lang.IllegalArgumentException SourceId:com.ibm.ws.security.orbssl.WSSSLServerSocketFactoryImpl.createSSLServerSocket ProbeId:459 Reporter:com.ibm.ws.security.orbssl.WSSSLServerSocketFactoryImpl@8f17aede
java.lang.IllegalArgumentException: Current mode settings do not allow the use of CipherSuite TLS\_AES\_256\_GCM\_SHA384
at com.ibm.jsse2.h.a(h.java:421)
at com.ibm.jsse2.bh.setEnabledCipherSuites(bh.java:6)
at com.ibm.ws.security.orbssl.WSSSLServerSocketFactoryImpl.createSSLServerSocket(WSSSLServerSocketFactoryImpl.java:430)
at com.ibm.ws.orbimpl.transport.WSTransport.createServerSocket(WSTransport.java:1564)
at com.ibm.ws.orbimpl.transport.WSTransport.startListening(WSTransport.java:891) As a
workaround, you can run the following wsadmin command. You need to modify the
cell name and node name in the commands.
wsadmin.sh -connType none -lang jython
AdminTask.modifySSLConfig('[-alias CellDefaultSSLSettings -scopeName (cell):cellname -sslProtocol TLSv1.2 -securityLevel CUSTOM -enabledCiphers "" ]')
AdminTask.modifySSLConfig('[-alias NodeDefaultSSLSettings -scopeName (cell):cellname:(node):nodename -sslProtocol TLSv1.2 -securityLevel CUSTOM -enabledCiphers "" ]')
AdminConfig.save()If you do not specify the scopeName parameter,
you get the following
error:WASX7015E: Exception running command: "AdminTask.modifySSLConfig('[-alias CellDefaultSSLSettings -sslProtocol TLSv1.2 -securityLevel CUSTOM -enabledCiphers "" ]')"; exception information:
 com.ibm.websphere.management.cmdframework.CommandValidationException: The managementScopes scopeName client is not found{noformat}
2. By default, WebSphere Application
Server
listens to several secure and nonsecured ports for HTTP traffic, ignoring the exact hostname clients
to connect. This action can cause concerns about possible host header injection because requests are
processed regardless of the host header value. You can make sure that Business Automation Workflow applications respond to
requests with a particular host port combination. For this, configure the
default\_host virtual host "host aliases" in the application server that uses a
script like the following. Replace the two initial variables to match your environment. If you use a
web server in front of your environment, use the web server's hostname and
port:targethostname='example.fyre.ibm.com'
targetport='9443'
cellName=AdminControl.getCell()
aliases=AdminUtilities.convertToList(AdminConfig.list('HostAlias', AdminConfig.getid( '/Cell:' + cellName + '/VirtualHost:default\_host/')))
for alias in aliases:
  port = AdminConfig.showAttribute(alias, 'port')
  if (port != targetport):
    print 'removing hostalias with port number ' + port
    AdminConfig.remove(alias)
  else:
    hostname = AdminConfig.showAttribute(alias, 'hostname')
    if ('*' == hostname):
      print 'modifying hostname from * to ' + targethostname + ' for hostalias with port ' + port
      AdminConfig.modify(alias, '[[hostname ' + targethostname + ']]')
    else:
      print 'there is already a non-wildcard hostname configured: ' + hostname

Important: The blank lines at the end of this sample are syntactically
important.
3 Configure HTTP or HTTPS communication restrictions. The HTTP protocolallows clients to control aspects of communication. For example, controllable aspects includechunked transfer encoding and requesting to keep connections alive. However, malicious use of thecommunication features might result in clients exhausting server side resources. For example, aclient might request connections to be kept alive and use chunked transfer encoding to sendincomplete HTTP messages. As a result, the server will wait for additional data on a connectionuntil there is a read timeout. Depending on your use case, consider the following communication restrictions:
    - Disabling HTTP request chunking. For more information, see Configuring inbound HTTP request chunking.
    - Reducing HTTP read timeout. For more information, see HTTP transport channel settings.
    - HTTP header size limitations and related restrictions. For more information, see HTTP transport channel settings.
4. Restart WebSphere Application
Server
console before completing other steps.

## SameSite cookie attribute

The SameSite attribute of the Set-Cookie HTTP response header
determines whether your cookie is restricted to a same-site context. WebSphere Application
Server supports SameSite cookie
attributes starting from 8.5.5.18. For more information, see PH22157: ADD
SUPPORT FOR THE SAMESITE COOKIE ATTRIBUTE.

- For the LTPA cookie, Business Automation Workflow adds the
com.ibm.websphere.security.addSameSiteAttributeToCookie custom property with the
default value of Strict. The property can be set to Strict,
Lax, or None. You might want to change the value to
Lax in certain integration scenarios. To update the value, go to
Security > Global security > Custom
properties in the administrative console.
- For the JESSIONID cookie, Business Automation Workflow adds the
CookieSameSite custom property with the default value of Strict.
The property can be set to Strict, Lax, or None.
You might want to change the value to Lax in certain integration scenarios. The
setting is in all servers of all types. To update the value, go to
Servers > Server Types > WebSphere
application
servers > server\_name > Session
management > Custom properties in the administrative
console.

When you upgrade your deployment environment from a release before 22.0.2, these configurations
are done during the upgrade process. If you think they might affect the functions of your
applications, you can change the custom properties in the administrative console after the upgrade.
Strict is the most secure setting that protects even against vulnerabilities we are
not aware of. If they need cross origin access (for example linking to a human service from another
origin), then lax or none can be required. Lax or None are not
vulnerable, but provide less "defense in depth".

## Related information

- setBPMProperty command
- getBPMProperty command
- deleteBPMProperty command